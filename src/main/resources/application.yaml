server:
  port: ${PORT:8080}
  servlet:
    context-path: /api

spring:
  application:
    name: token-gateway

  # Jackson configuration
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false
      indent-output: true
    deserialization:
      fail-on-unknown-properties: false

# JWT Configuration
jwt:
  secret: ${JWT_SECRET_KEY}
  expiration: 3600000 # 1 hour in milliseconds
  timezone: Africa/Kampala  # Uganda timezone (EAT - UTC+3)

# ESB Configuration
esb:
  base-url: ${BASE_URL}
  auth-endpoint: ${AUTH_URL}
  account-validation: ${ACCOUNT_VALIDATION}
  account-charge: ${ACCOUNT_CHARGE}
  connection-timeout: 60000  # 60 seconds (1 minute)
  read-timeout: 60000        # 60 seconds (1 minute)
  ssl:
    verify: ${ESB_SSL_VERIFY:false}  # false for dev, true for prod

# Feign Configuration
feign:
  client:
    config:
      default:
        connectTimeout: 60000      # 60 seconds (1 minute)
        readTimeout: 60000         # 60 seconds (1 minute)
        loggerLevel: full
      esb-client:
        connectTimeout: 60000      # 60 seconds (1 minute)
        readTimeout: 60000         # 60 seconds (1 minute)
        loggerLevel: full

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
  health:
    defaults:
      enabled: true

# Logging Configuration
logging:
  level:
    root: INFO
    com.pridebank.token: DEBUG
    com.pridebank.token.client.ESBClient: DEBUG
    feign: DEBUG
    feign.Logger: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/token-gateway.log
    max-size: 10MB
    max-history: 30

---
# Development Profile
spring:
  config:
    activate:
      on-profile: dev

logging:
  level:
    root: DEBUG
    com.pridebank.token: DEBUG
    feign: DEBUG

esb:
  ssl:
    verify: false  # Disable SSL verification in dev

feign:
  client:
    config:
      esb-client:
        loggerLevel: full  # Full logging in dev

---
# Production Profile
spring:
  config:
    activate:
      on-profile: prod

logging:
  level:
    root: INFO
    com.pridebank.token: INFO
    feign: INFO

esb:
  ssl:
    verify: true  # Enable SSL verification in prod

feign:
  client:
    config:
      esb-client:
        loggerLevel: basic  # Minimal logging in prod